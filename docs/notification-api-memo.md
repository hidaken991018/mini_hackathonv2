# 期限通知API 共有メモ（エンジニア向け）

## 現状の運用方針
- 自動実行（バッチ/cron）は未実装
- **手動でAPIを呼ぶと通知が生成される**運用

## 期限通知の生成API（手動）
**Method**: `POST`  
**Path**: `/api/notifications/expiry`  
**Body**:
```json
{ "userId": "mock-user-001" }
```

**動作概要**
- 在庫の期限をチェックして、対象日のものを通知として作成
- 消費期限（use_by）: **3日前 / 前日 / 当日**
- 賞味期限（best_before）: **7日前 / 3日前 / 当日**
- 在庫数量が **0以下** のものは対象外
- 期限未設定は対象外
- 期限切れ後は通知しない
- 通知は **1日1回** 想定（時刻固定）

**重複防止**
- 同じ在庫・同じ期限種別・同じ期限日・同じタイミングは再生成しない

**レスポンス例**
```json
{ "success": true, "data": { "createdCount": 2 } }
```

## 通知一覧の取得API（画面表示）
**Method**: `GET`  
**Path**: `/api/notifications?userId=mock-user-001`  

**動作概要**
- 指定ユーザーの通知一覧を返却（通知画面で利用）

## 補足（今後のToDo）
- 自動実行（バッチ/cron）を追加
- 全ユーザー対象の一括実行に拡張
- 認証/安全対策（管理者専用 or シークレット）
- 失敗時のリトライ/監視
